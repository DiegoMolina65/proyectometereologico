<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="css/styles.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    $(document).ready(function(){
      setInterval(function(){
        $.ajax({
          url: 'getdata.php',
          data: {topic: 'bme680'},
          dataType: 'json',
          success: function(data) {
            $('#temperature').text(data.temperature);
            $('#humidity').text(data.humidity);
            $('#pressure').text(data.pressure);
          }
        });
      }, 1000);  // refresh every 1 second
      
      setInterval(function(){
        $.ajax({
          url: 'getdata.php',
          data: {topic: 'mq135'},
          dataType: 'json',
          success: function(data) {
            $('#airQuality').text(data.air_quality);
          }
        });
      }, 2000);  // refresh every 2 seconds
      
      setInterval(function(){
        $.ajax({
          url: 'getdata.php',
          data: {topic: 'lluvia'},
          dataType: 'json',
          success: function(data) {
            $('#lluviaDetectada').text(data.lluvia_detectada);
            $('#acumuladoLluvia').text(data.acumulado_lluvia);
          }
        });
      }, 3000);  // refresh every 3 seconds
      
      setInterval(function(){
        $.ajax({
          url: 'getdata.php',
          data: {topic: 'viento'},
          dataType: 'json',
          success: function(data) {
            $('#velocidadViento').text(data.velocidad_viento);
          }
        });
      }, 4000);  // refresh every 4 seconds
    });
  </script>
</head>
<body>

<h1>Estado del Clima</h1>
<div id="sensorData">
  <table>
    <tr>
      <th>Sensor</th>
      <th>Valor</th>
    </tr>
    <tr>
      <td>Temperatura</td>
      <td id="temperature"></td>
    </tr>
    <tr>
      <td>Humedad</td>
      <td id="humidity"></td>
    </tr>
    <tr>
      <td>Presi√≥n</td>
      <td id="pressure"></td>
    </tr>
    <tr>
      <td>Lluvia Detectada</td>
      <td id="lluviaDetectada"></td>
    </tr>
    <tr>
      <td>Acumulado de Lluvia</td>
      <td id="acumuladoLluvia"></td>
    </tr>
    <tr>
      <td>Calidad del Aire</td>
      <td id="airQuality"></td>
    </tr>
    <tr>
      <td>Velocidad del Viento</td>
      <td id="velocidadViento"></td>
    </tr>
  </table>
</div>

</body>
</html>
